<div class="container">
  <h2>Ricerca Movimenti</h2>

  <form [formGroup]="form" (ngSubmit)="cerca()">
    <label>Tipo ricerca:</label>
    <select formControlName="tipoRicerca">
      <option value="1">Ultimi n movimenti + saldo</option>
      <option value="2">Ultimi n movimenti per categoria</option>
      <option value="3">Ultimi n movimenti fra due date</option>
    </select>

    <div>
      <label>n movimenti:</label>
      <input type="number" formControlName="n" />
    </div>

    <div *ngIf="form.value.tipoRicerca === '2'">
      <label>Categoria:</label>
      <input type="text" formControlName="categoria" />
    </div>

    <div *ngIf="form.value.tipoRicerca === '3'">
      <label>Data inizio:</label>
      <input type="date" formControlName="dataInizio" />
      <label>Data fine:</label>
      <input type="date" formControlName="dataFine" />
    </div>

    <button type="submit">Cerca</button>
  </form>

  <div *ngIf="movimenti.length > 0">
    <h3>Risultati</h3>
    <table>
      <thead>
        <tr>
          <th>Data</th>
          <th>Importo</th>
          <th>Categoria</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let m of movimenti">
          <td>{{ m.data }}</td>
          <td>{{ m.importo }}</td>
          <td>{{ m.CategoriaMovimentoid.NomeCategoria }}</td>
        </tr>
      </tbody>
    </table>

    <div *ngIf="saldoFinale !== null">
      <h4>Saldo finale: {{ saldoFinale }}</h4>
    </div>

    <button (click)="exportCSV()">Esporta CSV</button>
  </div>
</div>
